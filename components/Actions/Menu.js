import styled from "styled-components";

const MenuWrapper = styled.div`
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
`;

const MenuConcealer = styled.div`
    position: absolute;
    top: 0;
    background-color: var(--bg-color);
    height: 15rem;
    width: 100%;
`;

const MainMenu = styled.div`
    position: absolute;
    top: 0;
    width: 100%;
    display: flex;
    flex-direction: column;
    background-color: var(--color-white);
    border-radius: var(--border-radius);
    padding-bottom: calc(var(--button-void-size) / 2);
    overflow: hidden;

    transform: translateY(0);
    transition: transform var(--animation-speed) ease;

    &.menuIsShown {
        transform: translateY(calc(-100% - 0.5rem));
    }
`;

const MenuItem = styled.button`
    display: flex;
    align-items: center;
    justify-content: space-between;
    color: var(--course-color);
    font-size: var(--text-large);
    text-align: left;
    padding: 1rem 3rem;
    width: 100%;

    svg {
        height: 3.6rem;
        width: 3.3rem;
        path {
            fill: var(--course-color);
        }
    }

    &:hover {
        background: var(--course-color-light);
    }
`;

const RelativeWrapper = styled.div`
    position: relative;
`;

export default function Menu({
    muted,
    dispatch,
    actionState,
    resetTranscript,
    resetActionsState,
    toggleVoiceRecognition,
    browserSupportsSpeechRecognition,
}) {
    function onClickStartOver() {
        resetActionsState();
        resetTranscript();
        dispatch({ type: "RESET_STATE" });
    }

    function toggleMuted() {
        dispatch({ type: "TOGGLE_MUTE" });
    }

    const tab = actionState.menuIsShown ? "0" : "-1";

    return (
        <MenuWrapper>
            <RelativeWrapper>
                <MainMenu
                    className={actionState.menuIsShown ? "menuIsShown" : ""}>
                    <MenuItem tabIndex={tab} onClick={onClickStartOver}>
                        Start Over
                    </MenuItem>
                    <MenuItem tabIndex={tab} onClick={toggleMuted}>
                        <span>{muted ? "Unmute" : "Mute"}</span>
                        {muted ? (
                            <svg version='1.1' viewBox='0 0 321.957 321.957'>
                                <g transform='translate(0 -562.36)'>
                                    <path
                                        d='M160.6,611.381c-2.1,0-4.2,0.5-5.8,1.6l-95,47.2H14.2c-7.9,0-14.2,6.3-14.2,14.2v98.1c0,7.3,6.3,13.6,14.2,13.6h45.6
				l95,47.7c8.9,4.7,19.9-2.1,19.9-12.6v-195.7C174.8,617.681,168.5,611.381,160.6,611.381z M147,798.681l-77.7-38.8
				c-2.1-1-4.2-1.6-6.3-1.6H27.8v-69.8h35.3c2.1,0,4.2-0.5,6.3-1.6l77.6-38.8V798.681z'
                                    />
                                    <path
                                        d='M317.4,762.581L317.4,762.581l-38.9-39.1l39-39c9.4-8.9,2.6-24.1-10-24.1c-3.7,0.5-7.3,1.6-9.4,4.2l-39.2,39.4
				l-39.2-39.4c-2.6-2.6-6.3-4.2-10-4.2c-12.6,0-18.9,15.2-10,24.1l39.4,39.2l-38.8,39c-14.2,13.1,6.3,33.1,19.4,19.4l38.9-38.9
				l39.1,38.9C311.1,795.581,331,775.681,317.4,762.581z'
                                    />
                                </g>
                            </svg>
                        ) : (
                            <svg
                                version='1.1'
                                xmlns='http://www.w3.org/2000/svg'
                                viewBox='0 0 273.106 273.106'>
                                <g transform='translate(0 -562.36)'>
                                    <path
                                        d='M160.7,586.956c-2.1,0-4.2,0.5-5.8,1.6l-95,47.2H14.2c-7.9,0-14.2,6.3-14.2,14.2v98.1c0,7.3,6.3,13.6,14.2,13.6h45.7
				l95,47.7c8.9,4.7,19.9-2.1,19.9-12.6v-195.7C174.9,593.256,168.6,586.956,160.7,586.956z M147.1,774.256l-77.7-38.8
				c-2.1-1-4.2-1.6-6.3-1.6H27.9v-69.8h35.2c2.1,0,4.2-0.5,6.3-1.6l77.7-38.8V774.256z'
                                    />
                                    <path
                                        d='M210.1,660.456L210.1,660.456c-7.9,0-14.2,6.3-14.2,14.2v48.8c0,18.9,28.3,18.9,28.3,0v-48.8
				C224.3,666.756,218,659.856,210.1,660.456z'
                                    />
                                    <path
                                        d='M258.9,635.756c-7.9,0-14.2,6.3-13.6,14.2v98.1c-0.5,18.9,28.3,18.9,27.8,0v-98.1
				C273.1,642.056,266.8,635.756,258.9,635.756z'
                                    />
                                    <polygon points='258.9,635.756 258.9,635.756 258.9,635.756 			' />
                                </g>
                            </svg>
                        )}
                    </MenuItem>
                    {browserSupportsSpeechRecognition && navigator.onLine ? (
                        <MenuItem
                            tabIndex={tab}
                            onClick={toggleVoiceRecognition}>
                            <span>
                                {actionState.voiceRecognitionIsOn
                                    ? "Don't use voice"
                                    : "Use Voice"}
                            </span>
                            {actionState.voiceRecognitionIsOn ? (
                                <svg
                                    version='1.1'
                                    xmlns='http://www.w3.org/2000/svg'
                                    viewBox='0 0 475.085 475.085'>
                                    <title>Microphone is On</title>
                                    <path
                                        d='M237.541,328.897c25.128,0,46.632-8.946,64.523-26.83c17.888-17.884,26.833-39.399,26.833-64.525V91.365
			c0-25.126-8.938-46.632-26.833-64.525C284.173,8.951,262.669,0,237.541,0c-25.125,0-46.632,8.951-64.524,26.84
			c-17.893,17.89-26.838,39.399-26.838,64.525v146.177c0,25.125,8.949,46.641,26.838,64.525
			C190.906,319.951,212.416,328.897,237.541,328.897z'
                                    />
                                    <path
                                        d='M396.563,188.15c-3.606-3.617-7.898-5.426-12.847-5.426c-4.944,0-9.226,1.809-12.847,5.426
			c-3.613,3.616-5.421,7.898-5.421,12.845v36.547c0,35.214-12.518,65.333-37.548,90.362c-25.022,25.03-55.145,37.545-90.36,37.545
			c-35.214,0-65.334-12.515-90.365-37.545c-25.028-25.022-37.541-55.147-37.541-90.362v-36.547c0-4.947-1.809-9.229-5.424-12.845
			c-3.617-3.617-7.895-5.426-12.847-5.426c-4.952,0-9.235,1.809-12.85,5.426c-3.618,3.616-5.426,7.898-5.426,12.845v36.547
			c0,42.065,14.04,78.659,42.112,109.776c28.073,31.118,62.762,48.961,104.068,53.526v37.691h-73.089
			c-4.949,0-9.231,1.811-12.847,5.428c-3.617,3.614-5.426,7.898-5.426,12.847c0,4.941,1.809,9.233,5.426,12.847
			c3.616,3.614,7.898,5.428,12.847,5.428h182.719c4.948,0,9.236-1.813,12.847-5.428c3.621-3.613,5.431-7.905,5.431-12.847
			c0-4.948-1.81-9.232-5.431-12.847c-3.61-3.617-7.898-5.428-12.847-5.428h-73.08v-37.691
			c41.299-4.565,75.985-22.408,104.061-53.526c28.076-31.117,42.12-67.711,42.12-109.776v-36.547
			C401.998,196.049,400.185,191.77,396.563,188.15z'
                                    />
                                </svg>
                            ) : (
                                <svg
                                    version='1.1'
                                    xmlns='http://www.w3.org/2000/svg'
                                    viewBox='0 0 475.092 475.092'>
                                    <title>Microphone is Off</title>
                                    <path
                                        d='M113.922,269.803c-2.856-11.419-4.283-22.172-4.283-32.26v-36.55c0-4.947-1.809-9.229-5.424-12.847
			c-3.617-3.616-7.898-5.424-12.847-5.424c-4.952,0-9.235,1.809-12.851,5.424c-3.617,3.617-5.426,7.9-5.426,12.847v36.547
			c0,21.129,3.999,41.494,11.993,61.106L113.922,269.803z'
                                    />
                                    <path
                                        d='M237.545,328.897c25.126,0,46.638-8.946,64.521-26.83c17.891-17.884,26.837-39.399,26.837-64.525v-36.547L431.972,97.929
			c1.902-1.903,2.854-4.093,2.854-6.567c0-2.474-0.952-4.664-2.854-6.567l-23.407-23.413c-1.91-1.906-4.097-2.856-6.57-2.856
			c-2.472,0-4.661,0.95-6.564,2.856L43.117,413.698c-1.903,1.902-2.852,4.093-2.852,6.563c0,2.478,0.949,4.668,2.852,6.57
			l23.411,23.411c1.904,1.903,4.095,2.851,6.567,2.851c2.475,0,4.665-0.947,6.567-2.851l72.519-72.519
			c20.933,12.949,43.299,20.656,67.093,23.127v37.691h-73.089c-4.949,0-9.235,1.811-12.847,5.428
			c-3.618,3.613-5.43,7.898-5.43,12.847c0,4.941,1.812,9.233,5.43,12.847c3.612,3.614,7.898,5.428,12.847,5.428h182.718
			c4.948,0,9.232-1.813,12.847-5.428c3.62-3.613,5.428-7.905,5.428-12.847c0-4.948-1.808-9.233-5.428-12.847
			c-3.614-3.617-7.898-5.428-12.847-5.428h-73.087v-37.691c41.302-4.565,75.988-22.408,104.067-53.526
			c28.072-31.117,42.11-67.711,42.11-109.776v-36.554c0-4.947-1.808-9.229-5.421-12.845c-3.621-3.617-7.902-5.426-12.851-5.426
			c-4.945,0-9.229,1.809-12.847,5.426c-3.617,3.616-5.424,7.898-5.424,12.845v36.547c0,35.214-12.519,65.333-37.545,90.359
			s-55.151,37.544-90.362,37.544c-20.557,0-40.065-4.849-58.529-14.561l27.408-27.401
			C216.707,327.097,227.079,328.897,237.545,328.897z'
                                    />
                                    <path
                                        d='M290.223,16.849C274.518,5.618,256.959,0,237.545,0c-25.125,0-46.635,8.951-64.524,26.84
			c-17.89,17.89-26.835,39.399-26.835,64.525v146.177L323.483,60.244C317.008,42.543,305.927,28.077,290.223,16.849z'
                                    />
                                </svg>
                            )}
                        </MenuItem>
                    ) : null}
                </MainMenu>
                <MenuConcealer />
            </RelativeWrapper>
        </MenuWrapper>
    );
}
